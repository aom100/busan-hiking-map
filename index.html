<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>등산 맛집 지도</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <style>
        body { margin: 0; padding: 0; font-family: 'Malgun Gothic', sans-serif; }
        
        /* 지도가 화면에 꽉 차게 */
        #map { width: 100%; height: 100vh; }
        
        /* 제목 박스 스타일 */
        .title-box {
            position: absolute; top: 20px; left: 50%; transform: translateX(-50%);
            z-index: 10; background: white; padding: 10px 20px;
            border-radius: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.15);
            text-align: center; font-weight: bold; color: #2E8B57;
            border: 2px solid #2E8B57;
            width: 80%; max-width: 300px;
        }

        /* 내 위치 찾기 버튼 스타일 */
        .my-location-btn {
            position: absolute; bottom: 30px; right: 20px; z-index: 10;
            background-color: #ffffff; color: #333;
            border: none; border-radius: 5px;
            padding: 10px 15px; cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            font-weight: bold; font-size: 14px;
            display: flex; align-items: center; gap: 5px;
        }
        
        /* 말풍선 스타일 */
        .info-box { padding: 5px; width: 150px; text-align: center; }
        .info-title { font-weight: bold; display: block; margin-bottom: 5px; }
        .info-link { text-decoration: none; color: white; background: #2E8B57; padding: 3px 8px; border-radius: 3px; font-size: 11px; }
    </style>
</head>
<body>
    <div class="title-box">
        ⛰️ 등산 하산 맛집
    </div>
    
    <div id="map"></div>

    <button class="my-location-btn" onclick="findMyLocation()">
        ◎ 내 위치
    </button>

    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=fd3700902efcb45ab6ee8c1baf09338a"></script>
    
    <script>
        var mapContainer = document.getElementById('map'); 
        var mapCenter = new kakao.maps.LatLng(35.2355, 129.0831); // 금정산성
        var mapOption = { center: mapCenter, level: 4 };
        var map = new kakao.maps.Map(mapContainer, mapOption); 

        // 내 위치 마커 (빨간색)
        var myMarker = new kakao.maps.Marker({
            map: map,
            image: new kakao.maps.MarkerImage(
                'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_red.png', 
                new kakao.maps.Size(30, 40)
            )
        });
        myMarker.setVisible(false); // 처음엔 숨김

        // 1. 맛집 데이터
        var positions = [
            { title: '산성 오리불고기', lat: 35.2365, lng: 129.0845, link: 'https://place.map.kakao.com/1111' },
            { title: '금정 파전집', lat: 35.2345, lng: 129.0815, link: 'https://place.map.kakao.com/2222' },
            { title: '등산객 국수', lat: 35.2350, lng: 129.0855, link: 'https://place.map.kakao.com/3333' }
        ];

        // 2. 맛집 마커 찍기
        for (var i = 0; i < positions.length; i ++) {
            addMarker(positions[i]);
        }

        function addMarker(data) {
            var marker = new kakao.maps.Marker({
                map: map, position: new kakao.maps.LatLng(data.lat, data.lng)
            });
            var content = '<div class="info-box"><span class="info-title">' + data.title + '</span><a href="' + data.link + '" class="info-link" target="_blank">상세보기</a></div>';
            var infowindow = new kakao.maps.InfoWindow({ content: content, removable: true });
            kakao.maps.event.addListener(marker, 'click', function() { infowindow.open(map, marker); });
        }

        // 3. 내 위치 찾는 함수
        function findMyLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    var lat = position.coords.latitude;
                    var lon = position.coords.longitude;
                    var locPosition = new kakao.maps.LatLng(lat, lon); 

                    map.setCenter(locPosition);
                    myMarker.setPosition(locPosition);
                    myMarker.setVisible(true); 
                    
                }, function(error) {
                    alert("위치를 가져올 수 없습니다. GPS 설정을 확인해주세요.");
                });
            } else {
                alert("이 브라우저는 위치 정보를 지원하지 않습니다.");
            }
        }
    </script>
</body>
</html>